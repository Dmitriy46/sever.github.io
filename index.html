<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    /* –í–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
    body {
      font-family: Arial, sans-serif;
      font-size: 18px;
      margin: 0;
      padding: 10px;
      -webkit-text-size-adjust: 100%;
      background-color: #f5f5f5;
    }
    
    h1 {
      color: #2c3e50;
      text-align: center;
      font-size: 22px;
      margin: 10px 0;
      padding: 10px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    /* –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ –∫–∞–∫ –≤ –≤–∞—à–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ */
    /* ... */
  </style>
</head>
<body>
  <h1>üìã –î–∏—Å–ø–µ—Ç—á–µ—Ä –≥—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–æ–∫ (—Ç–µ—Å—Ç–æ–≤–∞—è –≤–µ—Ä—Å–∏—è)</h1>
  
  <div class="control-panel">
    <select id="sheetSelector" onchange="loadSheet()">
      <option value="">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞...</option>
    </select>
    <button onclick="showAddDialog()">üìÑ –ù–æ–≤—ã–π –ª–∏—Å—Ç</button>
    <button onclick="showRenameDialog()">‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω.</button>
    <button onclick="addRow()">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
    <button onclick="saveData()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button onclick="showDeleteDialog()" class="delete">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
    <button onclick="copyData()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    <button onclick="sendData()">üì§ Telegram</button>
  </div>
  
  <div class="table-container">
    <table id="dataTable">
      <thead>
        <tr>
          <th>–ú–∞—à–∏–Ω–∞</th>
          <th>–ì—Ä—É–∑</th>
          <th>–û—Ç–∫—É–¥–∞</th>
          <th>–ö—É–¥–∞</th>
          <th>–ó–∞–∫–∞–∑—á–∏–∫</th>
          <th>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  
  <div id="status" class="status"></div>
  
  <!-- –î–∏–∞–ª–æ–≥ —Å–æ–∑–¥–∞–Ω–∏—è –ª–∏—Å—Ç–∞ -->
  <div id="addDialog" class="dialog-overlay" style="display:none;">
    <div class="dialog">
      <h3>üìÑ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ª–∏—Å—Ç</h3>
      <p>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 10.06.2024):</p>
      <input type="text" id="newSheetName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞">
      <div class="dialog-buttons">
        <button onclick="hideDialog('addDialog')">–û—Ç–º–µ–Ω–∞</button>
        <button onclick="createNewSheet()" class="success">–°–æ–∑–¥–∞—Ç—å</button>
      </div>
    </div>
  </div>
  
  <!-- –î–∏–∞–ª–æ–≥ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è -->
  <div id="renameDialog" class="dialog-overlay" style="display:none;">
    <div class="dialog">
      <h3>‚úèÔ∏è –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ª–∏—Å—Ç</h3>
      <p>–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ:</p>
      <input type="text" id="renameSheetName">
      <div class="dialog-buttons">
        <button onclick="hideDialog('renameDialog')">–û—Ç–º–µ–Ω–∞</button>
        <button onclick="renameSheet()" class="success">–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å</button>
      </div>
    </div>
  </div>
  
  <!-- –î–∏–∞–ª–æ–≥ —É–¥–∞–ª–µ–Ω–∏—è -->
  <div id="deleteDialog" class="dialog-overlay" style="display:none;">
    <div class="dialog">
      <h3>üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –ª–∏—Å—Ç</h3>
      <p>–í—ã —Ç–æ—á–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å:</p>
      <p><strong id="deleteSheetName"></strong></p>
      <p>–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!</p>
      <p>–í–≤–µ–¥–∏—Ç–µ <strong>–£–î–ê–õ–ò–¢–¨</strong> –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:</p>
      <input type="text" id="confirmDeleteText" placeholder="–í–≤–µ–¥–∏—Ç–µ –£–î–ê–õ–ò–¢–¨">
      <div class="dialog-buttons">
        <button onclick="hideDialog('deleteDialog')">–û—Ç–º–µ–Ω–∞</button>
        <button onclick="confirmDelete()" class="delete">–£–¥–∞–ª–∏—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // –ò–º–∏—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (–∑–∞–º–µ–Ω—è–µ—Ç Google Apps Script)
    const mockBackend = {
      sheets: ['10.06.2024', '11.06.2024'],
      data: {
        '10.06.2024': [
          ['–ì–∞–∑–µ–ª—å', '–ú–µ–±–µ–ª—å', '–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ò–≤–∞–Ω–æ–≤ –ò.–ò.', '–•—Ä—É–ø–∫–∏–π –≥—Ä—É–∑'],
          ['–§—É—Ä–∞', '–û–≤–æ—â–∏', '–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä', '–ú–æ—Å–∫–≤–∞', '–ü–µ—Ç—Ä–æ–≤ –ü.–ü.', '–°—Ä–æ—á–Ω–æ']
        ],
        '11.06.2024': [
          ['–ö–∞–º–∞–∑', '–ü–µ—Å–æ–∫', '–ö–∞—Ä—å–µ—Ä', '–°—Ç—Ä–æ–π–∫–∞', '–°–∏–¥–æ—Ä–æ–≤ –°.–°.', '10 —Ç–æ–Ω–Ω']
        ]
      }
    };

    let currentSheet = '';
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏
    document.addEventListener('DOMContentLoaded', loadSheets);
    
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ª–∏—Å—Ç–æ–≤ (–∏–º–∏—Ç–∞—Ü–∏—è)
    function loadSheets() {
      showStatus("–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ª–∏—Å—Ç–æ–≤...");
      setTimeout(() => {
        const selector = document.getElementById('sheetSelector');
        selector.innerHTML = mockBackend.sheets.map(sheet => 
          `<option value="${sheet}">${sheet}</option>`
        ).join('');
        
        if (mockBackend.sheets.length > 0) {
          currentSheet = mockBackend.sheets[0];
          selector.value = currentSheet;
          loadSheet();
        }
      }, 500);
    }
    
    // –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ª–∏—Å—Ç–∞ (–∏–º–∏—Ç–∞—Ü–∏—è)
    function loadSheet() {
      const sheetName = document.getElementById('sheetSelector').value;
      if (!sheetName) return;
      
      showStatus(`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ "${sheetName}"...`);
      setTimeout(() => {
        const data = mockBackend.data[sheetName] || [];
        updateTable(data);
        showStatus(`–ó–∞–≥—Ä—É–∂–µ–Ω –ª–∏—Å—Ç "${sheetName}"`, 'success');
      }, 500);
    }
    
    // –û–±–Ω–æ–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function updateTable(data) {
      const tbody = document.querySelector('#dataTable tbody');
      tbody.innerHTML = '';
      
      data.forEach(row => {
        const tr = document.createElement('tr');
        for (let i = 0; i < 6; i++) {
          const td = document.createElement('td');
          td.contentEditable = true;
          td.textContent = row[i] || '';
          tr.appendChild(td);
        }
        tbody.appendChild(tr);
      });
    }
    
    // –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function addRow() {
      const tbody = document.querySelector('#dataTable tbody');
      const tr = document.createElement('tr');
      
      for (let i = 0; i < 6; i++) {
        const td = document.createElement('td');
        td.contentEditable = true;
        tr.appendChild(td);
      }
      
      tbody.appendChild(tr);
      tr.scrollIntoView({ behavior: 'smooth' });
      tr.firstChild.focus();
    }
    
    // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (–∏–º–∏—Ç–∞—Ü–∏—è)
    function saveData() {
      const rows = Array.from(document.querySelectorAll('#dataTable tbody tr'));
      const data = rows.map(row => 
        Array.from(row.cells).map(cell => cell.textContent)
      );
      
      showStatus("–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...");
      setTimeout(() => {
        if (!currentSheet) {
          showError("–ù–µ –≤—ã–±—Ä–∞–Ω –ª–∏—Å—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è");
          return;
        }
        
        mockBackend.data[currentSheet] = data;
        showStatus(`–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ "${currentSheet}"`, 'success');
      }, 500);
    }
    
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Telegram (–∏–º–∏—Ç–∞—Ü–∏—è)
    function sendData() {
      const rows = Array.from(document.querySelectorAll('#dataTable tbody tr'));
      const message = formatMessage(rows);
      
      showStatus("–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram (–∏–º–∏—Ç–∞—Ü–∏—è)...");
      setTimeout(() => {
        console.log("–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram:", message);
        showStatus("–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–∏–º–∏—Ç–∞—Ü–∏—è)", 'success');
      }, 500);
    }
    
    // –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function copyData() {
      const rows = Array.from(document.querySelectorAll('#dataTable tbody tr'));
      const message = formatMessage(rows);
      
      navigator.clipboard.writeText(message)
        .then(() => showStatus("–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!", 'success'))
        .catch(err => showError("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å: " + err));
    }
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function formatMessage(rows) {
      return rows
        .map((row, i) => {
          const cells = Array.from(row.cells).map(c => c.textContent.trim());
          return cells[0] ? 
            `${i+1}. üöõ ${cells[0]}\nüì¶ ${cells[1]}\nüìç ${cells[2]} ‚Üí ${cells[3]}\nüë§ ${cells[4]}\nüìù ${cells[5] || '-'}\n` : 
            null;
        })
        .filter(Boolean)
        .join('\n');
    }
    
    // –°–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç (–∏–º–∏—Ç–∞—Ü–∏—è)
    function createNewSheet() {
      const sheetName = document.getElementById('newSheetName').value.trim();
      if (!sheetName) {
        showError("–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞");
        return;
      }
      
      if (mockBackend.sheets.includes(sheetName)) {
        showError("–õ–∏—Å—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç");
        return;
      }
      
      setTimeout(() => {
        mockBackend.sheets.push(sheetName);
        mockBackend.data[sheetName] = [];
        hideDialog('addDialog');
        loadSheets();
        showStatus(`–°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –ª–∏—Å—Ç "${sheetName}"`, 'success');
      }, 500);
    }
    
    // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ª–∏—Å—Ç (–∏–º–∏—Ç–∞—Ü–∏—è)
    function renameSheet() {
      const newName = document.getElementById('renameSheetName').value.trim();
      if (!newName) {
        showError("–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ");
        return;
      }
      
      setTimeout(() => {
        const index = mockBackend.sheets.indexOf(currentSheet);
        if (index === -1) {
          showError("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ç–µ–∫—É—â–∏–π –ª–∏—Å—Ç");
          return;
        }
        
        // –ü–µ—Ä–µ–Ω–æ—Å–∏–º –¥–∞–Ω–Ω—ã–µ
        mockBackend.data[newName] = mockBackend.data[currentSheet];
        delete mockBackend.data[currentSheet];
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
        mockBackend.sheets[index] = newName;
        currentSheet = newName;
        
        hideDialog('renameDialog');
        loadSheets();
        showStatus(`–õ–∏—Å—Ç –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ "${newName}"`, 'success');
      }, 500);
    }
    
    // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ (–∏–º–∏—Ç–∞—Ü–∏—è)
    function confirmDelete() {
      const confirmText = document.getElementById('confirmDeleteText').value.trim();
      if (confirmText !== "–£–î–ê–õ–ò–¢–¨") {
        showError("–í–≤–µ–¥–∏—Ç–µ –£–î–ê–õ–ò–¢–¨ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è");
        return;
      }
      
      setTimeout(() => {
        const index = mockBackend.sheets.indexOf(currentSheet);
        if (index === -1) {
          showError("–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Ç–µ–∫—É—â–∏–π –ª–∏—Å—Ç");
          return;
        }
        
        // –£–¥–∞–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
        delete mockBackend.data[currentSheet];
        mockBackend.sheets.splice(index, 1);
        
        hideDialog('deleteDialog');
        loadSheets();
        showStatus(`–õ–∏—Å—Ç "${currentSheet}" —É–¥–∞–ª–µ–Ω`, 'success');
        currentSheet = mockBackend.sheets[0] || '';
      }, 500);
    }
    
    // –û—Å—Ç–∞–ª—å–Ω—ã–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
    function showDialog(id) {
      document.getElementById(id).style.display = 'flex';
    }
    
    function hideDialog(id) {
      document.getElementById(id).style.display = 'none';
    }
    
    function showStatus(message, type = '') {
      const statusEl = document.getElementById('status');
      statusEl.textContent = message;
      statusEl.className = 'status ' + type;
    }
    
    function showError(error) {
      console.error(error);
      showStatus(typeof error === 'string' ? error : error.message, 'error');
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function showRenameDialog() {
      if (!currentSheet) {
        showError("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ª–∏—Å—Ç");
        return;
      }
      
      document.getElementById('renameSheetName').value = currentSheet;
      showDialog('renameDialog');
      document.getElementById('renameSheetName').focus();
    }
    
    // –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ —É–¥–∞–ª–µ–Ω–∏—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    function showDeleteDialog() {
      if (!currentSheet) {
        showError("–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –ª–∏—Å—Ç");
        return;
      }
      
      document.getElementById('deleteSheetName').textContent = currentSheet;
      document.getElementById('confirmDeleteText').value = '';
      showDialog('deleteDialog');
      document.getElementById('confirmDeleteText').focus();
    }
  </script>
</body>
</html>